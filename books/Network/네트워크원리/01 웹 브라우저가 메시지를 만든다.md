# 1. HTTP 리퀘스트 메시지를 작성한다.

## 1. URL 입력부터 시작한다

- URL은 여러 프로토콜을 가질 수 있음: `ftp:`, `file:`, `mailto:` 등
- 주로 웹 서버에 액세스하는 클라이언트로 사용되지만, 파일 다운로드/업로드 및 메일 클라이언트 기능도 있음
- 모든 URL에는 접근 방법을 나타내는 프로토콜이 포함됨: `http:`, `ftp:` 등

## 2. 브라우저가 URL을 해독한다

`http: + // + www.lab.cyber.co.kr + /dir1/ + file1.html`

- `http:`: 프로토콜
- `//`: 나중에 이어지는 문자열이 서버의 이름을 나타냄
- `[디렉토리명/파일명]`: 생략 가능

## 3. 파일명을 생략한 경우

- **(a) http://www.lab.cyber.co.kr/dir/**: 파일명을 생략한 경우, 서버 측에서 `index.html` 또는 `default.html`로 연결
- **(b) http://www.lab.cyber.co.kr/**: 루트 디렉토리에서 기본 파일을 탐색
- **(c) http://www.lab.cyber.co.kr**: 기본 파일을 탐색
- **(d) http://www.lab.cyber.co.kr/whatisthis**: 파일 또는 디렉토리 여부 판단 후 액세스

## 4. HTTP의 기본 개념

- URL 해독 후 HTTP 프로토콜을 통해 웹 서버에 액세스
- HTTP 프로토콜은 클라이언트와 서버 간 메시지의 내용과 순서를 정의
- 리퀘스트 메시지에는 '무엇을'과 '어떻게 해서'가 포함됨
  - **URI**: 액세스할 파일 또는 프로그램의 이름
  - **메소드**: 서버가 수행할 동작을 나타냄

## 5. HTTP 리퀘스트 메시지를 만든다

- 첫 번째 행: 메소드, URI, HTTP 버전
- 두 번째 행 이후: 메시지 헤더 (부가 정보)
  - 날짜, 데이터 종류, 언어, 압축 형식, 소프트웨어 명칭 등
- 마지막: 공백 행 뒤 송신할 데이터 (메시지 본문)

## 6. 리퀘스트 메시지를 보내면 응답이 돌아온다

- 응답 메시지 포맷: 첫 번째 행에 스테이터스 코드와 응답 문구
- 이후: 헤더와 응답 데이터
- 클라이언트는 응답 메시지를 해석해 웹 페이지를 표시

# 2. 웹 서버의 IP 주소를 DNS 서버에 조회한다

## 1. IP 주소의 기본

- URL 해독 후, OS에 의뢰하여 액세스 대상의 웹 서버에 메시지를 송신
- 도메인명에서 IP 주소를 조사하는 과정이 필요
- **IP 주소**: 네트워크 주소와 호스트 번호를 합친 것
  - ex) `10.11.12.13`
- TCP/IP는 서브넷이라는 작은 네트워크를 라우터로 접속하여 전체 네트워크가 만들어진다고 생각할 수 있음
- 여기서 말하는 서브넷이란 허브에 몇 대의 PC가 접속 된것이라고 생각해도 좋다.
- 이렇게 한 개의 단위로 생각하여 서브넷이라고 부르는데, 라우터에서 연결하면 네트워크 전체가 완성된다.
- 네트워크 번호와 호스트 번호를 합쳐서 IP 주소라 한다.

## 2. 도메인명과 IP 주소를 구분하는 이유

- **도메인명**: 기억하기 쉬움
- **IP 주소**: 효율적인 실행을 위해 사용

## 3. Socket 라이브러리가 IP 주소를 찾는 기능을 한다

- 리졸버가 DNS 서버에 조회 메시지를 보내고 응답 메시지를 받아 IP 주소를 반환
- DNS 리졸버는 Socket 라이브러리를 통해 호출됨

## 4. 리졸버를 이용하여 DNS 서버를 조회한다

- 리졸버는 DNS 서버에 조회 메시지를 보내고, 응답 메시지에서 IP 주소를 추출해 브라우저에 전달

## 5. 리졸버의 내부 작동

- DNS 조회 메시지를 생성 후 프로토콜 스택에 송신을 의뢰

# 3. 전 세계의 DNS 서버가 연대한다

## 1. DNS 서버의 기본 동작

- 조회 메시지에는 이름, 클래스, 타입이 포함됨
  - **A 타입**: IP 주소 조회
  - **MX 타입**: 메일 배송 목적지 조회
- 도메인명과 타입에 맞는 정보를 조회 후 회답

## 2. 도메인의 계층

- DNS 정보는 계층적 구조를 가지며, 여러 DNS 서버가 정보를 분산 저장하고 연대하여 조회를 수행

## 3. 담당 DNS 서버를 찾아 IP 주소를 가져온다

- DNS 서버는 계층적 구조를 통해 루트 도메인부터 정보를 조회

## 4. DNS 서버는 캐시 기능으로 빠르게 회답할 수 있다

- DNS 서버는 조회한 이름과 IP 주소를 캐시에 저장해 빠르게 응답할 수 있음
- 캐시된 정보는 유효 기간을 가지며, 유효 기간이 지나면 삭제됨

# 4. 프로토콜 스택에 메시지 송신을 의뢰한다

## 1. 데이터 송수신 동작 개요

- IP 주소가 확인되면, OS의 프로토콜 스택에 메시지 송신을 의뢰
- 데이터 송수신 전, 소켓을 통해 파이프 연결 작업 필요
- 소켓을 통해 데이터를 주고받고, 전송 완료 후 파이프 분리

## 2. 소켓 작성 단계

- **Socket 라이브러리**의 `socket` 함수 호출을 통해 소켓 생성
- 소켓 식별을 위해 **디스크럽터**가 사용됨

## 3. 파이프를 연결하는 접속 단계

- `connect` 함수를 호출하여 서버 측 소켓에 연결
- 연결 시 디스크럽터, 서버의 IP 주소, 포트 번호를 지정

## 4. 메시지를 주고받는 송수신 단계

- **write** 함수로 데이터를 송신하고, **read** 함수로 수신
- 응답 메시지는 수신 버퍼에 저장

## 5. 연결 끊기 단계에서 송수신이 종료된다

- 브라우저가 데이터를 수신 완료하면, **close** 함수로 연결을 끊음
- HTTP 프로토콜은 데이터 수신 후 매번 연결을 끊지만, 여러 리퀘스트를 한 번에 처리하는 방식도 있음
